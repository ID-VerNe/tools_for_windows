# Windows 网络适配器管理器 (NIC Manager GUI)

一个简单的图形用户界面 (GUI) 工具，用于在 Windows 系统上查看、启用和禁用网络适配器。

## 功能

*   **列出适配器**: 显示系统上所有网络适配器及其当前状态（已启用/已禁用）。
*   **启用/禁用**: 允许用户选择列表中的适配器并执行启用或禁用操作。
*   **管理员权限检查**:
    *   启动时自动检测是否以管理员权限运行。
    *   如果未以管理员身份运行，会显示提示信息，并提供一个按钮尝试以管理员权限重新启动程序。
    *   在非管理员模式下，禁用和启用按钮将被禁用，防止操作失败。
*   **刷新列表**: 提供刷新按钮以重新获取最新的适配器列表和状态。
*   **状态栏**: 在底部显示当前操作状态或提示信息。
*   **编码处理**: 尝试处理 `netsh` 命令可能产生的不同编码输出（如 UTF-8, GBK）。

## 运行要求

*   **操作系统**: Windows (因为使用了 `netsh` 命令和 Windows API `ctypes`)
*   **Python**: Python 3.x
*   **依赖库**:
    *   `tkinter` (Python 标准库，通常自带)
    *   `ctypes` (Python 标准库)

## 如何运行

1.  确保您的系统满足上述 **运行要求**。
2.  将 `nic_manager_gui.py` 和 `utils.py` 文件放在同一个目录下。
3.  打开命令提示符 (cmd) 或 PowerShell，切换到该目录。
4.  运行主程序：
    ```bash
    python nic_manager_gui.py
    ```
5.  **重要**: 为了能够启用或禁用网络适配器，您需要以 **管理员权限** 运行此脚本。
    *   您可以右键点击 `nic_manager_gui.py` 文件，选择“以管理员身份运行”（如果安装了合适的 Python 启动器）。
    *   或者，先以管理员身份打开命令提示符/PowerShell，然后再执行 `python nic_manager_gui.py` 命令。
    *   如果程序启动时检测到非管理员权限，它会提供一个按钮让您尝试以管理员身份重新启动。

## 文件结构

*   `nic_manager_gui.py`: 主程序文件，包含 Tkinter GUI 界面的代码。
*   `utils.py`: 辅助模块，包含与系统交互的函数（检查管理员权限、执行 `netsh` 命令、解析输出等）。

## 注意事项与限制

*   **依赖 `netsh`**: 功能的核心依赖于 Windows 的 `netsh interface` 命令。如果该命令不可用或行为异常，程序可能无法工作。
*   **`netsh` 输出解析**: 程序通过解析 `netsh` 命令的文本输出来获取适配器信息。如果未来 Windows 更新改变了 `netsh` 的输出格式，解析逻辑可能需要调整。
*   **编码问题**: 虽然已尝试处理多种编码，但在极端情况下，如果 `netsh` 输出的编码无法识别，适配器名称或状态可能显示不正确。
*   **仅限 Windows**: 由于使用了 Windows 特定的 API 和命令，此工具无法在 macOS 或 Linux 上运行。